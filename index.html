<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MockeX Proxy</title>
<style>
body { background:#111; color:#0f0; font-family:monospace; text-align:center; padding:20px; }
button { padding:10px 20px; margin:10px; cursor:pointer; }
input { padding:5px; width:200px; margin:5px; }
#displayBox { border:1px solid #0f0; padding:10px; margin:10px auto; width:350px; min-height:50px; }
</style>
</head>
<body>
<h1>MockeX Proxy Dashboard</h1>

<button id="activateBtn">Activate Proxy</button>
<div id="displayBox">Proxy not active</div>

<h2>Connect to Proxy</h2>
<input type="text" id="ipInput" placeholder="Enter Proxy IP">
<input type="number" id="portInput" placeholder="Enter Proxy Port">
<button id="connectBtn">Connect</button>

<h2>Status</h2>
<div id="statusBox"></div>

<script>
const backendURL = "http://127.0.0.1:5000"; // replace with deployed backend URL

document.getElementById('activateBtn').addEventListener('click', async () => {
    const res = await fetch(`${backendURL}/activate`, { method:'POST' });
    const data = await res.json();
    document.getElementById('displayBox').innerText = 
        `Proxy IP: ${data.ip}\nProxy Port: ${data.port}`;
});

document.getElementById('connectBtn').addEventListener('click', async () => {
    const ip = document.getElementById('ipInput').value;
    const port = parseInt(document.getElementById('portInput').value);
    const res = await fetch(`${backendURL}/connect`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ ip, port })
    });
    const data = await res.json();
    alert(data.status || data.error);
    updateStatus();
});

async function updateStatus(){
    const res = await fetch(`${backendURL}/status`);
    const data = await res.json();
    let content = `Proxy IP: ${data.proxy_ip}\nProxy Port: ${data.proxy_port}\n\nConnected Clients:\n`;
    data.clients.forEach(c => {
        content += `- ${c.ip}:${c.port}\n`;
    });
    document.getElementById('statusBox').innerText = content;
}

setInterval(updateStatus, 5000);
</script>
</body>
</html>    displayBox.textContent = content;
}

// Auto refresh every 5 seconds
setInterval(updateDisplay, 5000);
</script>
</body>
</html>
