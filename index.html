<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FF Mock Proxy Dashboard</title>
<style>
body { margin:0; padding:0; font-family:'Segoe UI',sans-serif; background: linear-gradient(135deg,#0a0a0a,#1a001a); color:#fff; text-align:center;}
h1,h2,h3 { text-shadow:0 0 10px #ff00ff,0 0 20px #ff00ff;}
input { padding:10px; margin:10px; border-radius:5px; border:none; outline:none; width:200px; text-align:center; background:#222; color:#fff; box-shadow:0 0 10px #ff00ff;}
button { padding:10px 20px; margin:10px; border:none; border-radius:5px; cursor:pointer; background:#ff00ff; color:#000; font-weight:bold; box-shadow:0 0 15px #ff00ff,0 0 25px #ff00ff inset; transition:0.3s;}
button:hover { transform: scale(1.1);}
#dashboard { margin:20px auto; background:rgba(50,0,50,0.8); padding:20px; border-radius:10px; width:90%; max-width:600px; box-shadow:0 0 20px #ff00ff;}
#socialIsland { display:flex; flex-wrap:wrap; justify-content:center; margin:20px auto; background:rgba(20,0,20,0.8); padding:15px; border-radius:10px; width:90%; max-width:900px; box-shadow:0 0 25px #ff00ff;}
.itemCard { background:#222; color:#fff; width:140px; margin:10px; padding:10px; border-radius:10px; text-align:center; box-shadow:0 0 10px #ff00ff; transition:transform 0.2s, box-shadow 0.2s;}
.itemCard:hover { transform: scale(1.1); box-shadow:0 0 20px #ff00ff;}
.itemImg { width:100px; height:100px; border-radius:5px; object-fit:cover; margin-bottom:5px;}
#errorMsg { margin-top:15px; font-weight:bold; }
#ipPortBox { margin-top:15px; padding:10px; background:#111; border-radius:5px; box-shadow:0 0 10px #ff00ff; display:inline-block;}
</style>
</head>
<body>
<h1>FF Mock Proxy Dashboard</h1>
<input id="uidInput" placeholder="Enter your UID">
<button onclick="activateDashboard()">Activate</button>

<div id="dashboard"></div>
<div id="socialIsland"></div>
<div id="ipPortBox" style="display:none;"></div>
<div id="errorMsg"></div>

<script>
let timerInterval = null;
let sessionSeconds = 2*60*60;
let currentUID = null;
const backendURL = 'http://localhost:3000';

function formatTime(sec){
    const h=Math.floor(sec/3600).toString().padStart(2,'0');
    const m=Math.floor((sec%3600)/60).toString().padStart(2,'0');
    const s=Math.floor(sec%60).toString().padStart(2,'0');
    return `${h}:${m}:${s}`;
}

async function activateDashboard(){
    const uid = document.getElementById('uidInput').value;
    const errorDiv = document.getElementById('errorMsg');
    if(!uid){ 
        errorDiv.innerHTML='<span style="color:red">Enter your UID to activate!</span>';
        return;
    }
    errorDiv.innerHTML='';
    currentUID=uid;

    const res = await fetch(`${backendURL}/activate`,{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({uid})
    });
    const data = await res.json();

    const ipPortDiv = document.getElementById('ipPortBox');
    ipPortDiv.style.display='inline-block';
    ipPortDiv.innerHTML=`<span style="color:#0f0">Proxy IP: ${data.proxyIP} | Port: ${data.proxyPort}</span>`;

    if(timerInterval) clearInterval(timerInterval);
    sessionSeconds=2*60*60;
    updateDashboard();

    timerInterval=setInterval(()=>{
        sessionSeconds--;
        updateDashboard();
        if(sessionSeconds<=0) sessionSeconds=2*60*60;
    },1000);
}

async function updateDashboard(){
    if(!currentUID) return;
    const res=await fetch(`${backendURL}/dashboard/${currentUID}`);
    const data=await res.json();
    const dashboardDiv=document.getElementById('dashboard');
    dashboardDiv.innerHTML=`
        <h2>UID: ${currentUID}</h2>
        <p>Session Active: ${formatTime(sessionSeconds)}</p>
        <h3>Items (Fake)</h3>
        <p>Diamonds: ${data.items.diamonds}</p>
        <p>Bundles: ${data.items.bundles.join(', ')}</p>
        <p>Emotes: ${data.items.emotes.join(', ')}</p>
        <p>Skins: ${data.items.skins.join(', ')}</p>
    `;
    renderSocialIsland(data.items);
}

function renderSocialIsland(items){
    const islandDiv=document.getElementById('socialIsland');
    islandDiv.innerHTML='';
    const allItems=[...items.bundles,...items.emotes,...items.skins];
    allItems.forEach(item=>{
        const card=document.createElement('div');
        card.className='itemCard';
        card.innerHTML=`<img class="itemImg" src="https://via.placeholder.com/100?text=${encodeURIComponent(item)}" alt="${item}"><p>${item}</p>`;
        islandDiv.appendChild(card);
    });
}

// Simulate IP/Port click
document.getElementById('ipPortBox').addEventListener('click', async ()=>{
    if(!currentUID){
        const res=await fetch(`${backendURL}/use-proxy`);
        const data=await res.json();
        document.getElementById('errorMsg').innerHTML=`<span style="color:red">${data.error}</span>`;
    } else {
        const res=await fetch(`${backendURL}/use-proxy/${currentUID}`);
        const data=await res.json();
        document.getElementById('errorMsg').innerHTML=`<span style="color:lime">${data.message}</span>`;
    }
});
</script>
</body>
</html>